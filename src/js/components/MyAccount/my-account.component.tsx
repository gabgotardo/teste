import { useEffect, useState } from "react";
import {
  MyAccountWrapper,
  UserIcon,
  UserName,
  Link,
} from "./my-account.styles";

const MyAccount = () => {
  const [orderForm, setOrderForm] = useState(null);

  useEffect(() => {
    // @ts-ignore
    vtexjs.checkout.getOrderForm().done(orderForm => {
      setOrderForm(orderForm);
    });
  }, []);

  if (!orderForm) return null;

  const { clientProfileData, loggedIn } = orderForm;

  return (
    <MyAccountWrapper>
      <Link href="/_secure/account">
        <UserIcon>
          <svg
            width="28"
            height="28"
            viewBox="0 0 28 28"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M14 15.2727C15.491 15.2727 16.9485 14.8249 18.1881 13.9858C19.4278 13.1467 20.3941 11.954 20.9646 10.5587C21.5352 9.16331 21.6845 7.62789 21.3936 6.14658C21.1027 4.66528 20.3848 3.30461 19.3305 2.23664C18.2762 1.16868 16.933 0.441385 15.4707 0.146734C14.0084 -0.147917 12.4926 0.00330869 11.1152 0.581287C9.73768 1.15927 8.56033 2.13804 7.732 3.39383C6.90366 4.64962 6.46154 6.12604 6.46154 7.63637C6.46154 9.66166 7.25577 11.604 8.6695 13.0361C10.0832 14.4682 12.0007 15.2727 14 15.2727ZM14 2.18182C15.065 2.18182 16.106 2.50172 16.9915 3.10108C17.877 3.70043 18.5672 4.55231 18.9747 5.549C19.3823 6.54569 19.4889 7.64242 19.2812 8.7005C19.0734 9.75858 18.5605 10.7305 17.8075 11.4933C17.0544 12.2561 16.095 12.7756 15.0505 12.9861C14.006 13.1966 12.9233 13.0886 11.9394 12.6757C10.9555 12.2629 10.1145 11.5637 9.52286 10.6667C8.93119 9.76975 8.61538 8.71517 8.61538 7.63637C8.61701 6.19024 9.18484 4.80381 10.1943 3.78124C11.2038 2.75868 12.5724 2.18347 14 2.18182ZM21.5385 17.0909H6.46154C4.74783 17.0909 3.10431 17.7805 1.89254 19.008C0.680767 20.2355 0 21.9004 0 23.6364C0 24.7937 0.453845 25.9036 1.26169 26.7219C2.06954 27.5403 3.16522 28 4.30769 28H23.6923C24.8348 28 25.9305 27.5403 26.7383 26.7219C27.5462 25.9036 28 24.7937 28 23.6364C28 21.9004 27.3192 20.2355 26.1075 19.008C24.8957 17.7805 23.2522 17.0909 21.5385 17.0909ZM23.6923 25.8182H4.30769C3.73666 25.8175 3.1892 25.5874 2.78542 25.1784C2.38163 24.7694 2.1545 24.2148 2.15385 23.6364C2.15516 22.4795 2.60942 21.3703 3.41699 20.5523C4.22455 19.7342 5.31947 19.2741 6.46154 19.2727H21.5385C22.6805 19.2741 23.7754 19.7342 24.583 20.5523C25.3906 21.3703 25.8448 22.4795 25.8462 23.6364C25.8455 24.2148 25.6184 24.7694 25.2146 25.1784C24.8108 25.5874 24.2633 25.8175 23.6923 25.8182Z"
              fill="white"
            />
          </svg>
        </UserIcon>
        {loggedIn && <UserName>Ol√°, {clientProfileData.firstName} </UserName>}
      </Link>
    </MyAccountWrapper>
  );
};

export default MyAccount;
